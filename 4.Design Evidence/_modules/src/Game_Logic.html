

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.Game_Logic &mdash; Property Tycoon V1.0 Documentation V1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=d43430bd"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Property Tycoon V1.0 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules/main.html">Main Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/game.html">Game Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/game_logic.html">Game Logic Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/game_actions.html">Game Actions Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/game_event_handler.html">Game Event Handler Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/game_renderer.html">Game Renderer Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/player.html">Player Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/board.html">Board Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/property.html">Property Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/ai_player_logic.html">AI Player Logic Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/cards.html">Cards Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/ui.html">UI Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/development_mode.html">Development Mode Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/loadexcel.html">Load Excel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/sound_manager.html">Sound Manager Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/font_manager.html">Font Manager Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Property Tycoon V1.0 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.Game_Logic</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.Game_Logic</h1><div class="highlight"><pre>
<span></span><span class="c1"># Base on PropertyTycoonCardData.xlsx from canvas</span>
<span class="c1"># script based on Eric&#39;s provided flowchart photo (flowchart.drawio.png)</span>
<span class="c1"># will add more comment later to reference for which part of code is based on which part of the flowchart</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.Loadexcel</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_property_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.Sound_Manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">sound_manager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.Ai_Player_Logic</span><span class="w"> </span><span class="kn">import</span> <span class="n">EasyAIPlayer</span>

<span class="n">pot_luck_cards</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You inherit £200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You have won 2nd prize in a beauty contest, collect £50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You are up the creek with no paddle - go back to the Old Creek&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Student loan refund. Collect £20&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Bank error in your favour. Collect £200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Pay bill for text books of £100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">100</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Mega late night taxi bill pay £50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">50</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Advance to go&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;From sale of Bitcoin you get £50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Bitcoin assets fall - pay off Bitcoin short fall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">50</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Pay a £10 fine or take opportunity knocks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Pay insurance fee of £50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Savings bond matures, collect £100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Go to jail. Do not pass GO, do not collect £200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Received interest on shares of £25&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">25</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;It&#39;s your birthday. Collect £10 from each player&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_birthday_collection</span><span class="p">(</span>
            <span class="n">player</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Get out of jail free&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span>
            <span class="n">bank</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
<span class="p">]</span>

<span class="n">opportunity_knocks_cards</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Bank pays you divided of £50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You have won a lip sync battle. Collect £100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Advance to Turing Heights&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Advance to Han Xin Gardens&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="mi">25</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">+</span> <span class="p">(</span><span class="mi">200</span> <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Fined £15 for speeding&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Pay university fees of £150&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">150</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Take a trip to Hove station&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="mi">16</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">+</span> <span class="p">(</span><span class="mi">200</span> <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Loan matures, collect £150&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">150</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">-</span> <span class="mi">150</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You are assessed for repairs, £40/house, £115/hotel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_repair_assessment</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">115</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Advance to GO&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You are assessed for repairs, £25/house, £100/hotel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_repair_assessment</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">100</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Go back 3 spaces&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">((</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">bank</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Advance to Skywalker Drive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="mi">12</span><span class="p">,</span>
            <span class="n">bank</span> <span class="o">+</span> <span class="p">(</span><span class="mi">200</span> <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Go to jail. Do not pass GO, do not collect £200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Drunk in charge of a hoverboard. Fine £30&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">board</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span>
            <span class="n">player</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Get out of jail free&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">player</span><span class="p">,</span> <span class="n">bank</span><span class="p">,</span> <span class="n">free_parking</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span>
            <span class="n">bank</span><span class="p">,</span>
            <span class="n">free_parking</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
<span class="p">]</span>


<div class="viewcode-block" id="GameLogic">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GameLogic</span><span class="p">:</span>
    <span class="n">BANK_LIMIT</span> <span class="o">=</span> <span class="mi">50000</span>
    <span class="n">MAX_HOUSES_PER_PROPERTY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">MAX_HOTELS_PER_PROPERTY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">GAME_TOKENS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;boot&quot;</span><span class="p">,</span> <span class="s2">&quot;smartphone&quot;</span><span class="p">,</span> <span class="s2">&quot;ship&quot;</span><span class="p">,</span> <span class="s2">&quot;hatstand&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;iron&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANK_LIMIT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">load_property_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_going_to_jail</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_dice_roll</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_queue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bankrupted_players</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voluntary_exits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">available_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAME_TOKENS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pot_luck_cards</span> <span class="o">=</span> <span class="n">pot_luck_cards</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opportunity_knocks_cards</span> <span class="o">=</span> <span class="n">opportunity_knocks_cards</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pot_luck_cards</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opportunity_knocks_cards</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai_difficulty</span> <span class="o">=</span> <span class="s2">&quot;easy&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span> <span class="o">=</span> <span class="n">EasyAIPlayer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="GameLogic.validate_bank_transaction">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.validate_bank_transaction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_bank_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bank does not have sufficient funds&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.pay_from_bank">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.pay_from_bank">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pay_from_bank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_bank_transaction</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">-=</span> <span class="n">amount</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.pay_to_bank">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.pay_to_bank">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pay_to_bank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">:</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.game_start">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.game_start">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">game_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">load_property_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.add_player">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.add_player">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_player</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">player_name</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">player</span>
            <span class="n">player_is_ai</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="s2">&quot;is_ai&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="p">)</span>

            <span class="n">token_index</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="s2">&quot;player_number&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="s2">&quot;player_number&quot;</span><span class="p">)</span>
                <span class="k">else</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAME_TOKENS</span><span class="p">[</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">token_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAME_TOKENS</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAME_TOKENS</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="n">new_player</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">player_name</span><span class="p">,</span>
                <span class="s2">&quot;money&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
                <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;is_ai&quot;</span><span class="p">:</span> <span class="n">player_is_ai</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span><span class="p">[</span><span class="n">player_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Added player </span><span class="si">{</span><span class="n">player_name</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2"> token&quot;</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Maximum number of players reached&quot;</span></div>


<div class="viewcode-block" id="GameLogic.advance_to_next_player">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.advance_to_next_player">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">advance_to_next_player</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span>
        <span class="n">current_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">current_player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="n">current_player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;bankrupt&quot;</span><span class="p">,</span> <span class="kc">False</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">players</span>
            <span class="p">)</span>
            <span class="n">current_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">current_player</span></div>


<div class="viewcode-block" id="GameLogic.play_turn">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.play_turn">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">play_turn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">current_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">current_player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="n">current_player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;bankrupt&quot;</span><span class="p">,</span> <span class="kc">False</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">players</span>
            <span class="p">)</span>
            <span class="n">current_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_going_to_jail</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">dice1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">dice2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_dice_roll</span> <span class="o">=</span> <span class="p">(</span><span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">current_player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">try_leave_jail</span><span class="p">(</span><span class="n">current_player</span><span class="p">,</span> <span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance_to_next_player</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span>

        <span class="k">if</span> <span class="n">dice1</span> <span class="o">==</span> <span class="n">dice2</span><span class="p">:</span>
            <span class="n">sound_manager</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">&quot;roll_doubles&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rolled three doubles and goes to jail!&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_jail</span><span class="p">(</span><span class="n">current_player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance_to_next_player</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dice1</span> <span class="o">+</span> <span class="n">dice2</span>
        <span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_pos</span> <span class="o">%</span> <span class="mi">40</span>

        <span class="k">if</span> <span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>

        <span class="k">if</span> <span class="n">new_pos</span> <span class="o">&gt;=</span> <span class="mi">40</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_going_to_jail</span><span class="p">:</span>
            <span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">200</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">-=</span> <span class="mi">200</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span><span class="p">[</span><span class="n">current_player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> collected £200 for passing GO&quot;</span><span class="p">)</span>

        <span class="n">result</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_space</span><span class="p">(</span><span class="n">current_player</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;bankrupt&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is bankrupt!&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;jail&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dice1</span> <span class="o">==</span> <span class="n">dice2</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_going_to_jail</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance_to_next_player</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span></div>


<div class="viewcode-block" id="GameLogic.add_message">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.add_message">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[GAME] </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GameLogic.handle_space">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_space">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
        <span class="n">space_type</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;20&quot;</span><span class="p">:</span>
            <span class="n">sound_manager</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">&quot;land_free_parking&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;free_parking&quot;</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">space_type</span> <span class="o">==</span> <span class="s2">&quot;special&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">space_type</span> <span class="o">==</span> <span class="s2">&quot;tax&quot;</span><span class="p">:</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £</span><span class="si">{</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;game&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">show_tax_popup</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">])</span>

            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Cannot buy property while in jail&quot;</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;can_be_bought&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Would you like to buy </span><span class="si">{</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">?&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;can_buy&quot;</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
            <span class="n">owner</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">owner</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">owner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is in jail and cannot collect rent&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="n">rent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_space_rent</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">rent</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">rent</span>
                <span class="n">owner</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rent</span>
                <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £</span><span class="si">{</span><span class="n">rent</span><span class="si">}</span><span class="s2"> rent to </span><span class="si">{</span><span class="n">owner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;game&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">show_rent_popup</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">rent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> went bankrupt!&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_bankruptcy</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;bankrupt&quot;</span><span class="p">,</span> <span class="n">message</span>

        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.handle_jail">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_jail">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_jail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span>
        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_going_to_jail</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Go to jail. Do not pass GO, do not collect £200&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;Go to jail. Do not pass GO, do not collect £200&quot;</span></div>


<div class="viewcode-block" id="GameLogic.try_leave_jail">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.try_leave_jail">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">try_leave_jail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">dice1</span><span class="p">,</span> <span class="n">dice2</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s2">&quot;jail_turns&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player</span><span class="p">:</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_jail_choice</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;card&quot;</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> uses Get Out of Jail Free card and left jail!&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">dice1</span> <span class="o">==</span> <span class="n">dice2</span><span class="p">:</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubles_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rolled doubles (</span><span class="si">{</span><span class="n">dice1</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dice2</span><span class="si">}</span><span class="s2">) and left jail!&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_jail_choice</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;pay&quot;</span>
        <span class="p">):</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">50</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="mi">50</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £50 and left jail&quot;</span>

        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">50</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="mi">50</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £50 after 3 turns and left jail&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_bankruptcy</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="kc">True</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> couldn&#39;t pay jail fine and left jail bankrupt&quot;</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> stays in jail (turn </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;jail_turns&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/3)&quot;</span></div>


<div class="viewcode-block" id="GameLogic.check_game_over">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.check_game_over">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_game_over</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_mode</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">:</span>
            <span class="n">active_players</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">active_players</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">active_players</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_mode</span> <span class="o">==</span> <span class="s2">&quot;abridged&quot;</span><span class="p">:</span>
            <span class="n">min_rounds</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rounds_completed</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">min_rounds</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">rounds</span> <span class="o">==</span> <span class="n">min_rounds</span> <span class="k">for</span> <span class="n">rounds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounds_completed</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
                    <span class="n">total</span> <span class="o">=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                            <span class="n">total</span> <span class="o">+=</span> <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                                <span class="n">total</span> <span class="o">+=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                    <span class="s2">&quot;house_cost&quot;</span><span class="p">,</span> <span class="mi">0</span>
                                <span class="p">)</span>
                    <span class="n">assets</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">total</span>
                <span class="n">winner</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">assets</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">winner</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.calculate_space_rent">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.calculate_space_rent">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_space_rent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="s2">&quot;Station&quot;</span> <span class="ow">in</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
            <span class="n">station_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;Station&quot;</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="mi">25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">station_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Tesla Power Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Edison Water&quot;</span><span class="p">]:</span>
            <span class="n">utility_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Tesla Power Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Edison Water&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">dice_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_dice_roll</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_dice_roll</span> <span class="k">else</span> <span class="mi">7</span>
            <span class="k">return</span> <span class="n">dice_total</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="k">if</span> <span class="n">utility_count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">base_rent</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rent&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">house_rents</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_costs&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">house_index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">space</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">house_rents</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">house_rents</span><span class="p">[</span><span class="n">house_index</span><span class="p">]</span>

        <span class="n">color_group</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color_group</span><span class="p">:</span>
            <span class="n">all_owned</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">space</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">color_group</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">all_owned</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">base_rent</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">base_rent</span></div>


<div class="viewcode-block" id="GameLogic.handle_card_draw">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_card_draw">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_card_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">card_type</span><span class="p">):</span>
        <span class="n">cards</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pot_luck_cards</span>
            <span class="k">if</span> <span class="n">card_type</span> <span class="o">==</span> <span class="s2">&quot;Pot Luck&quot;</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">opportunity_knocks_cards</span>
        <span class="p">)</span>
        <span class="n">card</span> <span class="o">=</span> <span class="n">cards</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">card</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;game&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">show_card_popup</span><span class="p">(</span><span class="n">card_type</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s2">&quot;Get out of jail free&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">action_result</span><span class="p">,</span> <span class="n">new_bank</span><span class="p">,</span> <span class="n">new_parking</span> <span class="o">=</span> <span class="n">card</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">](</span>
                    <span class="n">player</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span><span class="p">,</span> <span class="bp">self</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">action_result</span><span class="p">,</span> <span class="n">new_bank</span><span class="p">,</span> <span class="n">new_parking</span> <span class="o">=</span> <span class="n">card</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">](</span>
                    <span class="n">player</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action_result</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">action_result</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_result</span>
                <span class="k">if</span> <span class="n">action_result</span> <span class="o">&lt;</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">action_result</span> <span class="o">!=</span> <span class="mi">11</span><span class="p">:</span>
                    <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">200</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">-=</span> <span class="mi">200</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Collected £200 for passing GO&quot;</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;moved&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Updating player money from </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">action_result</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_result</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">=</span> <span class="n">new_bank</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">=</span> <span class="n">new_parking</span>

        <span class="n">cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">message</span></div>


<div class="viewcode-block" id="GameLogic.calculate_repair_cost">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.calculate_repair_cost">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_repair_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">house_cost</span><span class="p">,</span> <span class="n">hotel_cost</span><span class="p">):</span>
        <span class="n">total_cost</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                <span class="n">houses</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">houses</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">total_cost</span> <span class="o">+=</span> <span class="n">hotel_cost</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total_cost</span> <span class="o">+=</span> <span class="n">houses</span> <span class="o">*</span> <span class="n">house_cost</span>
        <span class="k">return</span> <span class="n">total_cost</span></div>


<div class="viewcode-block" id="GameLogic.check_property_group_completion">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.check_property_group_completion">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_property_group_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player_name</span><span class="p">):</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player_name</span><span class="p">:</span>
                <span class="n">groups</span><span class="p">[</span><span class="n">prop</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">group_totals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span>
                <span class="n">group_totals</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_totals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">completed_groups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">group_totals</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="n">group_totals</span><span class="p">[</span><span class="n">group</span><span class="p">]:</span>
                <span class="n">completed_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;🎊 MONOPOLY! 🎊&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player_name</span><span class="si">}</span><span class="s2"> completed the </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2"> set!&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Utilities&quot;</span><span class="p">,</span> <span class="s2">&quot;Stations&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Houses can now be built on these properties!&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">completed_groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="GameLogic.buy_property">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.buy_property">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">buy_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> cannot buy property while in jail&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> must pass GO before buying property&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">])</span>
        <span class="n">property_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">price</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_bank_transaction</span><span class="p">(</span><span class="n">price</span><span class="p">):</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">price</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">price</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_property_group_completion</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.auction_property">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.auction_property">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">auction_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Starting Auction for Property at Position </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Invalid property position </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Invalid property position </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;auction_completed&quot;</span>

        <span class="n">property_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;property&quot;</span><span class="p">,</span> <span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;utility&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Cannot auction non-purchasable property&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Cannot auction non-purchasable property&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;auction_completed&quot;</span>

        <span class="n">eligible_players</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eligible players: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">eligible_players</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">eligible_players</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Money: £</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">eligible_players</span><span class="p">:</span>
            <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No eligible players for auction - property remains unsold&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;auction_completed&quot;</span>

        <span class="n">starting_bid</span> <span class="o">=</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting bid: £</span><span class="si">{</span><span class="n">starting_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="n">property_data</span><span class="p">,</span>
            <span class="s2">&quot;property_position&quot;</span><span class="p">:</span> <span class="n">position</span><span class="p">,</span>
            <span class="s2">&quot;active_players&quot;</span><span class="p">:</span> <span class="n">eligible_players</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s2">&quot;passed_players&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
            <span class="s2">&quot;highest_bidder&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;current_bid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;minimum_bid&quot;</span><span class="p">:</span> <span class="n">starting_bid</span><span class="p">,</span>
            <span class="s2">&quot;current_bidder_index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">(),</span>
            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
            <span class="s2">&quot;completed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Auction started for </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - Starting bid: £</span><span class="si">{</span><span class="n">starting_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auction initialized with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">eligible_players</span><span class="p">)</span><span class="si">}</span><span class="s2"> active players&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First bidder: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;active_players&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔨 AUCTION: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting bid: £</span><span class="si">{</span><span class="n">starting_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sound_manager</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">&quot;auction_start&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;auction_in_progress&quot;</span></div>


<div class="viewcode-block" id="GameLogic.process_auction_bid">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.process_auction_bid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_auction_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">bid_amount</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Processing Bid: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempted bid amount: £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;current_auction&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No active auction&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;No active auction in progress&quot;</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> has already passed&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;You have already passed on this auction&quot;</span>

        <span class="k">if</span> <span class="n">bid_amount</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;minimum_bid&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error: Bid too low (minimum: £</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;minimum_bid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Bid must be at least £</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;minimum_bid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">bid_amount</span> <span class="o">&gt;</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Insufficient funds (available: £</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;You don&#39;t have enough money&quot;</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
        <span class="n">remaining_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span>
            <span class="o">-</span> <span class="n">current_time</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">remaining_time</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Bid timeout&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> took too long to bid - automatically passed&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bid accepted!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Previous high bid: £</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;current_bid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- New high bid: £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;- Previous leader: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;highest_bidder&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;highest_bidder&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- New leader: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;current_bid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bid_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;highest_bidder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;minimum_bid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bid_amount</span> <span class="o">+</span> <span class="mi">10</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bids £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_to_next_bidder</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bids £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="GameLogic.process_auction_pass">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.process_auction_pass">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_auction_pass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Processing Pass: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;current_auction&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No active auction&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;No active auction in progress&quot;</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> has already passed&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;You have already passed on this auction&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> passes on bidding&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> passes&quot;</span><span class="p">)</span>

        <span class="n">active_bidders</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active bidders remaining: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">active_bidders</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bidder</span> <span class="ow">in</span> <span class="n">active_bidders</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">bidder</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">move_to_next_bidder</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> passes&quot;</span></div>


<div class="viewcode-block" id="GameLogic.check_auction_end">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.check_auction_end">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_auction_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;current_auction&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;completed&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Auction is marked as completed - processing outcome&quot;</span><span class="p">)</span>

            <span class="n">property_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;property&quot;</span><span class="p">]</span>
            <span class="n">highest_bidder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;highest_bidder&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">highest_bidder</span><span class="p">:</span>
                <span class="n">bid_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;current_bid&quot;</span><span class="p">]</span>
                <span class="n">highest_bidder</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">bid_amount</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">bid_amount</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buy_property_after_auction</span><span class="p">(</span><span class="n">highest_bidder</span><span class="p">,</span> <span class="n">property_data</span><span class="p">)</span>

                <span class="n">result_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">highest_bidder</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bought </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auction completed - </span><span class="si">{</span><span class="n">result_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">result_message</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result_message</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No one bid on </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, it remains unsold&quot;</span>
                <span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auction completed - </span><span class="si">{</span><span class="n">result_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">result_message</span><span class="p">)</span>

            <span class="k">return</span> <span class="s2">&quot;auction_completed&quot;</span>

        <span class="n">active_bidders</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">active_bidders</span>
            <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_bidders</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;highest_bidder&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;All players have passed or only highest bidder remains - auction is complete&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_auction_end</span><span class="p">()</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">]</span>
            <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Auction timed out - marking as complete&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_auction_end</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.move_to_next_bidder">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.move_to_next_bidder">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">move_to_next_bidder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;current_auction&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No active auction&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Moving to Next Bidder ===&quot;</span><span class="p">)</span>

        <span class="n">active_players</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span>
            <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;minimum_bid&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active players remaining: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">active_players</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Money: £</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Only one or zero active players remaining&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;highest_bidder&quot;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Auction ending - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;highest_bidder&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> wins with bid of £</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;current_bid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;highest_bidder&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;One active player remaining (</span><span class="si">{</span><span class="n">active_players</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) with no current bids - giving them a chance to bid&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">player</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">active_players</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;current_bidder_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                        <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No active players or highest bidder - auction will end&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;current_bidder_index&quot;</span><span class="p">]</span>
            <span class="n">original_index</span> <span class="o">=</span> <span class="n">current_index</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current bidder index: </span><span class="si">{</span><span class="n">current_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Current bidder: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s1">&#39;active_players&#39;</span><span class="p">][</span><span class="n">current_index</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="n">found_next_bidder</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">found_next_bidder</span><span class="p">:</span>
                <span class="n">next_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">next_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;active_players&quot;</span><span class="p">][</span><span class="n">next_index</span><span class="p">]</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">next_player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;passed_players&quot;</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">next_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;minimum_bid&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">found_next_bidder</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;current_bidder_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_index</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Next bidder: </span><span class="si">{</span><span class="n">next_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (index </span><span class="si">{</span><span class="n">next_index</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="n">current_index</span> <span class="o">=</span> <span class="n">next_index</span>

                <span class="k">if</span> <span class="n">current_index</span> <span class="o">==</span> <span class="n">original_index</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cycled through all players - no eligible bidders found&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;completed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_auction</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timer reset for next bidder&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GameLogic.is_game_over">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.is_game_over">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_game_over</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">active_players</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="GameLogic.get_winner">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.get_winner">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_winner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_game_over</span><span class="p">():</span>
            <span class="n">active_players</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">active_players</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">active_players</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.remove_player">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.remove_player">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_player</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player_name</span><span class="p">,</span> <span class="n">voluntary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player_name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">player</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player_name</span><span class="p">:</span>
                    <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;houses&quot;</span> <span class="ow">in</span> <span class="n">prop</span><span class="p">:</span>
                        <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">voluntary</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;exited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">voluntary_exits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;bankrupt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bankrupted_players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_player_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">players</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.auction">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.auction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">auction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_queue</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">msg</span>
            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_queue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">msg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Would you like to buy&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">auction_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;🔨 AUCTION: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is up for auction!&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">auction_message</span><span class="p">)</span>

        <span class="n">eligible_players</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exited&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">eligible_players</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No eligible players for auction. </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> remains unsold.&quot;</span>
            <span class="p">)</span>
            <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="n">winning_bid_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">placeBids</span><span class="p">(</span><span class="n">eligible_players</span><span class="p">,</span> <span class="n">property_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">winning_bid_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> remains unsold&quot;</span><span class="p">)</span>
            <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">winner</span><span class="p">,</span> <span class="n">bid</span> <span class="o">=</span> <span class="n">winning_bid_info</span>
            <span class="k">if</span> <span class="n">winner</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bid</span><span class="p">:</span>
                <span class="n">winner</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">bid</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">bid</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">winner</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;🎊 </span><span class="si">{</span><span class="n">winner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> won </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_property_group_completion</span><span class="p">(</span><span class="n">winner</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">winner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> cannot afford the winning bid&quot;</span>
                <span class="p">)</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.placeBids">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.placeBids">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">placeBids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player_list</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Property Auction Debug ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting auction for&quot;</span><span class="p">,</span> <span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Property position:&quot;</span><span class="p">,</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting price: £&quot;</span><span class="p">,</span> <span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">current_minimum</span> <span class="o">=</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">active_players</span> <span class="o">=</span> <span class="n">player_list</span><span class="p">[:]</span>
        <span class="n">current_bids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">round_count</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Auction Round&quot;</span><span class="p">,</span> <span class="n">round_count</span><span class="p">,</span> <span class="s2">&quot;===&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Active players:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">active_players</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current minimum bid: £&quot;</span><span class="p">,</span> <span class="n">current_minimum</span><span class="p">)</span>

            <span class="n">round_bids</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">active_players</span><span class="p">[:]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Player&quot;</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;&#39;s turn&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available money: £&quot;</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;is in jail - skipping&quot;</span><span class="p">)</span>
                    <span class="n">active_players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">bid</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">bid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ai_bid</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">current_minimum</span><span class="p">,</span> <span class="n">property_data</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bid</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bids £</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bids £</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> passes&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> passes&quot;</span><span class="p">)</span>
                        <span class="n">active_players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current_bids</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">current_minimum</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">bid</span> <span class="ow">and</span> <span class="n">bid</span> <span class="o">&gt;=</span> <span class="n">current_minimum</span> <span class="ow">and</span> <span class="n">bid</span> <span class="o">&lt;=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]:</span>
                    <span class="n">round_bids</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">bid</span>
                    <span class="n">current_bids</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">bid</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">active_players</span><span class="p">:</span>
                        <span class="n">active_players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">round_bids</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">active_players</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No valid bids this round&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="k">if</span> <span class="n">round_bids</span><span class="p">:</span>
                <span class="n">highest_bid</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">round_bids</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">highest_bidders</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">p</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">active_players</span>
                    <span class="k">if</span> <span class="n">round_bids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">highest_bid</span>
                <span class="p">]</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Round Results:&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highest bid: £</span><span class="si">{</span><span class="n">highest_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highest bidders: </span><span class="si">{</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">highest_bidders</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">active_players</span> <span class="o">=</span> <span class="n">highest_bidders</span>
                <span class="n">current_minimum</span> <span class="o">=</span> <span class="n">highest_bid</span> <span class="o">+</span> <span class="mi">10</span>

            <span class="n">round_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">winner</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">final_bid</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">winner</span> <span class="o">=</span> <span class="n">active_players</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">final_bid</span> <span class="o">=</span> <span class="n">current_bids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">winner</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">current_minimum</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">winner</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Auction Complete ===&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Winner: </span><span class="si">{</span><span class="n">winner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Winning bid: £</span><span class="si">{</span><span class="n">final_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">winner</span><span class="p">,</span> <span class="n">final_bid</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Auction ended with no winner&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.get_ai_bid">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.get_ai_bid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ai_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">current_minimum</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== AI Bid Evaluation ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI Player: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current minimum: £</span><span class="si">{</span><span class="n">current_minimum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available money: £</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">current_minimum</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DECISION: Cannot bid - insufficient funds&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">base_value</span> <span class="o">=</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
        <span class="n">value_multiplier</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base value assessment:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Property price: £</span><span class="si">{</span><span class="n">base_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;group&quot;</span> <span class="ow">in</span> <span class="n">property_data</span><span class="p">:</span>
            <span class="n">owned_in_group</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">total_in_group</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Group analysis:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Group: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Owned in group: </span><span class="si">{</span><span class="n">owned_in_group</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_in_group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">owned_in_group</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group_bonus</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="p">(</span><span class="n">owned_in_group</span> <span class="o">/</span> <span class="n">total_in_group</span><span class="p">)</span>
                <span class="n">value_multiplier</span> <span class="o">+=</span> <span class="n">group_bonus</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Adding group bonus: +</span><span class="si">{</span><span class="n">group_bonus</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;Station&quot;</span> <span class="ow">in</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
            <span class="n">owned_stations</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;Station&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">station_bonus</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">owned_stations</span>
            <span class="n">value_multiplier</span> <span class="o">+=</span> <span class="n">station_bonus</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Station analysis:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Owned stations: </span><span class="si">{</span><span class="n">owned_stations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Adding station bonus: +</span><span class="si">{</span><span class="n">station_bonus</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Tesla Power Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Edison Water&quot;</span><span class="p">]:</span>
            <span class="n">owned_utilities</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Tesla Power Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Edison Water&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Utility analysis:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Owned utilities: </span><span class="si">{</span><span class="n">owned_utilities</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">owned_utilities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">value_multiplier</span> <span class="o">+=</span> <span class="mf">0.5</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Adding utility bonus: +0.5x&quot;</span><span class="p">)</span>

        <span class="n">perceived_value</span> <span class="o">=</span> <span class="n">base_value</span> <span class="o">*</span> <span class="n">value_multiplier</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Value calculation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Base value: £</span><span class="si">{</span><span class="n">base_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Final multiplier: </span><span class="si">{</span><span class="n">value_multiplier</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Perceived value: £</span><span class="si">{</span><span class="n">perceived_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">max_bid</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="n">perceived_value</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum possible bid: £</span><span class="si">{</span><span class="n">max_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_bid</span> <span class="o">&lt;=</span> <span class="n">current_minimum</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DECISION: Pass - maximum bid below minimum&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

        <span class="n">bid_headroom</span> <span class="o">=</span> <span class="n">max_bid</span> <span class="o">-</span> <span class="n">current_minimum</span>
        <span class="n">increment</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">bid_headroom</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)))</span>
        <span class="n">bid</span> <span class="o">=</span> <span class="n">current_minimum</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">increment</span><span class="p">)</span>
        <span class="n">bid</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bid</span><span class="p">,</span> <span class="n">max_bid</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bid calculation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Bid headroom: £</span><span class="si">{</span><span class="n">bid_headroom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Chosen increment: £</span><span class="si">{</span><span class="n">increment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Initial bid: £</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bid</span> <span class="o">&gt;</span> <span class="n">perceived_value</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="n">risky_bid_chance</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Risk assessment:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Bid (£</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">) is above 80% of perceived value&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Risk check: </span><span class="si">{</span><span class="n">risky_bid_chance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (will pass if &lt; 0.3)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">risky_bid_chance</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DECISION: Pass due to risk assessment&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FINAL DECISION: Bid £</span><span class="si">{</span><span class="n">bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bid</span></div>


<div class="viewcode-block" id="GameLogic.get_human_bid">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.get_human_bid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_human_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">current_minimum</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Player </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, would you like to bid? (Yes/No) Current minimum bid: £</span><span class="si">{</span><span class="n">current_minimum</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, enter &#39;Yes&#39; or &#39;No&#39; (30s timeout): &quot;</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="s2">&quot;Timeout: Player did not respond in time, skipping bid&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bid_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, what is your bid? (Enter amount): &quot;</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                            <span class="s2">&quot;Timeout: Player took too long to enter bid amount&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="n">bid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bid_input</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bid</span> <span class="o">&lt;</span> <span class="n">current_minimum</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bid must be at least £</span><span class="si">{</span><span class="n">current_minimum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">bid</span> <span class="o">&gt;</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Insufficient funds&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">bid</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing bid: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Please enter &#39;Yes&#39; or &#39;No&#39;&quot;</span><span class="p">)</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="k">continue</span></div>


<div class="viewcode-block" id="GameLogic.buy_property_after_auction">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.buy_property_after_auction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">buy_property_after_auction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed_circuits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> must pass GO before buying property&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">position</span><span class="p">][</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> now owns </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_property_group_completion</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Property position </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2"> not found in properties list&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.handle_bankruptcy">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_bankruptcy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_bankruptcy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">total_liquidated</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">property_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;houses&quot;</span> <span class="ow">in</span> <span class="n">prop</span> <span class="ow">and</span> <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">house_costs</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_costs&quot;</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="k">if</span> <span class="n">house_costs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">house_costs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">house_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">house_costs</span><span class="p">[:</span> <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">house_value</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">value</span> <span class="o">+=</span> <span class="n">house_value</span>
                <span class="n">property_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prop</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">value</span><span class="p">))</span>
                <span class="n">total_liquidated</span> <span class="o">+=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="n">property_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🏦 Liquidating </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;s properties:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">property_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: £</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total liquidated: £</span><span class="si">{</span><span class="n">total_liquidated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="s2">&quot;houses&quot;</span> <span class="ow">in</span> <span class="n">prop</span><span class="p">:</span>
                    <span class="n">prop</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;bankrupt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bankrupted_players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.can_build_house">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.can_build_house">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_build_house</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_last_build_check_time&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&gt;</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">=</span> <span class="n">current_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== DEBUG: can_build_house CHECK ===&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Player: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property position: </span><span class="si">{</span><span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot build - property is mortgaged&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot build on mortgaged property&quot;</span>

        <span class="n">color_group</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Color group: </span><span class="si">{</span><span class="n">color_group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">color_group</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot build - not a valid property group&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot build houses on this type of property&quot;</span>

        <span class="n">color_group_properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">color_group</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total properties in group: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">color_group_properties</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">color_group_properties</span><span class="p">:</span>
                <span class="n">prop_owner</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> (Position: </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, Owner: </span><span class="si">{</span><span class="n">prop_owner</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">color_group_properties</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                    <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
                <span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cannot build - </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> is owned by </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, not </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Must own all </span><span class="si">{</span><span class="n">color_group</span><span class="si">}</span><span class="s2"> properties to build&quot;</span>

        <span class="n">current_houses</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current houses on property: </span><span class="si">{</span><span class="n">current_houses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">color_group_properties</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="o">!=</span> <span class="n">property_data</span><span class="p">:</span>
                <span class="n">other_houses</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                    <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
                <span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">other_houses</span><span class="si">}</span><span class="s2"> houses&quot;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">current_houses</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="n">other_houses</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                        <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
                    <span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Cannot build - houses must be built evenly. This property would have </span><span class="si">{</span><span class="n">current_houses</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> houses while </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">other_houses</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Must build houses evenly across properties&quot;</span>

        <span class="k">if</span> <span class="n">current_houses</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot build - maximum development reached&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Maximum development reached&quot;</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can build house: YES&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.can_build_hotel">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.can_build_hotel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_build_hotel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_last_build_check_time&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&gt;</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">=</span> <span class="n">current_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== DEBUG: can_build_hotel CHECK ===&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Player: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">is_group_complete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_property_group_completion</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_group_complete</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot build hotel - player does not own all properties in the group&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;You must own all properties in the color group&quot;</span>

        <span class="n">color_group</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">current_houses</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current houses on property: </span><span class="si">{</span><span class="n">current_houses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">current_houses</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot build hotel - property must have exactly 4 houses&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Must have 4 houses before building a hotel&quot;</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">color_group</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="o">!=</span> <span class="n">property_data</span><span class="p">:</span>
                <span class="n">other_houses</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                    <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
                <span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">other_houses</span><span class="si">}</span><span class="s2"> houses&quot;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">other_houses</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
                        <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
                    <span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;Cannot build hotel - all properties must have at least 4 houses&quot;</span>
                        <span class="p">)</span>
                    <span class="k">return</span> <span class="p">(</span>
                        <span class="kc">False</span><span class="p">,</span>
                        <span class="s2">&quot;All properties in the set must have at least 4 houses before building a hotel&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_check_debug_enabled</span>
            <span class="ow">and</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_build_check_time</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can build hotel: YES&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.build_house">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.build_house">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_house</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">can_build</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_build_house</span><span class="p">(</span><span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">can_build</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">current_houses</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_houses</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAX_HOUSES_PER_PROPERTY</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Maximum number of houses already built&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">house_cost</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_cost&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">house_cost</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_bank_transaction</span><span class="p">(</span><span class="n">house_cost</span><span class="p">):</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">house_cost</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">house_cost</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_houses</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> built a house on </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Not enough money to build a house&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.build_hotel">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.build_hotel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_hotel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">can_build</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_build_hotel</span><span class="p">(</span><span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">can_build</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">hotel_cost</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_cost&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">hotel_cost</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_bank_transaction</span><span class="p">(</span><span class="n">hotel_cost</span><span class="p">):</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">hotel_cost</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">hotel_cost</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> built a hotel on </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Not enough money to build a hotel&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.sell_house">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.sell_house">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sell_house</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">current_houses</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_houses</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;No houses to sell&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">color_group</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">color_group</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="o">!=</span> <span class="n">property_data</span><span class="p">:</span>
                <span class="n">other_houses</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">current_houses</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">other_houses</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                        <span class="s2">&quot;Cannot have more than 1 house difference between properties in a set&quot;</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

        <span class="n">house_cost</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_cost&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">house_cost</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">-=</span> <span class="n">house_cost</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_houses</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> sold a house from </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.sell_hotel">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.sell_hotel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sell_hotel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;No hotel to sell&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">hotel_cost</span> <span class="o">=</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;house_cost&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hotel_cost</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">-=</span> <span class="n">hotel_cost</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;houses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> sold a hotel from </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.mortgage_property">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.mortgage_property">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mortgage_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is already mortgaged&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="s2">&quot;Cannot mortgage property with houses/hotels&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">mortgage_value</span> <span class="o">=</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pay_from_bank</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">mortgage_value</span><span class="p">)</span>
        <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> mortgaged </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">mortgage_value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">sound_manager</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">&quot;mortgage&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="GameLogic.unmortgage_property">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.unmortgage_property">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmortgage_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not mortgaged&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">unmortgage_cost</span> <span class="o">=</span> <span class="p">(</span><span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span>
        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">unmortgage_cost</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pay_to_bank</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">unmortgage_cost</span><span class="p">)</span>
            <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> unmortgaged </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">unmortgage_cost</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">sound_manager</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">&quot;unmortgage&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not enough money to unmortgage </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.handle_rent_payment">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_rent_payment">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_rent_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">landing_player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property is mortgaged - no rent due&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">owner</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
            <span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]),</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">owner</span> <span class="ow">or</span> <span class="n">owner</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Owner is in jail - no rent collected&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">rent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_space_rent</span><span class="p">(</span><span class="n">property_data</span><span class="p">,</span> <span class="n">landing_player</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">landing_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">rent</span><span class="p">:</span>
            <span class="n">landing_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">rent</span>
            <span class="n">owner</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">landing_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £</span><span class="si">{</span><span class="n">rent</span><span class="si">}</span><span class="s2"> rent to </span><span class="si">{</span><span class="n">owner</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;game&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">show_rent_popup</span><span class="p">(</span>
                    <span class="n">landing_player</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">rent</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_bankruptcy</span><span class="p">(</span><span class="n">landing_player</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.calculate_house_difference">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.calculate_house_difference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_house_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_group_properties</span><span class="p">):</span>
        <span class="n">house_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">color_group_properties</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">house_counts</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">house_counts</span><span class="p">)</span></div>


<div class="viewcode-block" id="GameLogic.handle_ai_turn">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_ai_turn">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_ai_turn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">jail_decision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">get_jail_decision</span><span class="p">(</span>
                <span class="n">player</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">last_dice_roll</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">jail_decision</span> <span class="o">==</span> <span class="s2">&quot;use_card&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">jail_free_cards</span><span class="p">[</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">jail_decision</span> <span class="o">==</span> <span class="s2">&quot;pay&quot;</span> <span class="ow">and</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">50</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="mi">50</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;in_jail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;jail_turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">owned_properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">prop</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">development_priorities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">get_development_priority</span><span class="p">(</span>
            <span class="n">owned_properties</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">development_priorities</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">should_develop_property</span><span class="p">(</span>
                <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="n">owned_properties</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">build_hotel</span><span class="p">(</span><span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">build_house</span><span class="p">(</span><span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">owned_properties</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">should_mortgage_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mortgage_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">mortgaged_properties</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">owned_properties</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">mortgaged_properties</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">should_unmortgage_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unmortgage_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.process_ai_property_purchase">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.process_ai_property_purchase">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_ai_property_purchase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">owned_properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">prop</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">should_buy_property</span><span class="p">(</span>
            <span class="n">property_data</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="n">owned_properties</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pay_to_bank</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">])</span>
                <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> buys </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for £</span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GameLogic.get_ai_auction_bid">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.get_ai_auction_bid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ai_auction_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">,</span> <span class="n">current_bid</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== AI Auction Bid Logic ===&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI Player: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current bid: £</span><span class="si">{</span><span class="n">current_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Player money: £</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">minimum_bid</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">current_bid</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">property_data</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minimum_bid</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI can&#39;t afford minimum bid of £</span><span class="si">{</span><span class="n">minimum_bid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">owned_properties</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">prop</span>
                <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="p">]</span>

            <span class="n">bid_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai_player</span><span class="o">.</span><span class="n">make_auction_bid</span><span class="p">(</span>
                <span class="n">property_data</span><span class="p">,</span> <span class="n">current_bid</span><span class="p">,</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="n">owned_properties</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">bid_amount</span>
                <span class="ow">and</span> <span class="n">bid_amount</span> <span class="o">&gt;</span> <span class="n">current_bid</span>
                <span class="ow">and</span> <span class="n">bid_amount</span> <span class="o">&lt;=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">bid_amount</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bid_amount</span><span class="p">,</span> <span class="n">current_bid</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> decided to bid £</span><span class="si">{</span><span class="n">bid_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bid_amount</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AI </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> decided to pass&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in AI auction bidding: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="GameLogic.handle_ai_bankruptcy_prevention">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_ai_bankruptcy_prevention">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_ai_bankruptcy_prevention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount_needed</span><span class="p">):</span>

        <span class="n">owned_properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">prop</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">owned_properties</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">owned_properties</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount_needed</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sell_hotel</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> sold hotel on </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> to raise funds&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sell_house</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> sold house on </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> to raise funds&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount_needed</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">owned_properties</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount_needed</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mortgage_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> mortgaged </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> to raise funds&quot;</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount_needed</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount_needed</span></div>


<div class="viewcode-block" id="GameLogic.handle_buy_decision">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_buy_decision">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_buy_decision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">decision</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">])</span>
        <span class="n">property_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;in_jail&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Cannot buy property while in jail&quot;</span>

        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Property is already owned&quot;</span>

        <span class="k">if</span> <span class="n">property_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_mortgaged&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Property is mortgaged and cannot be purchased&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Property Purchase Decision ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Player: </span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decision: </span><span class="si">{</span><span class="n">decision</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_ai&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ai_property_purchase</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">property_data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bought </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;purchase_completed&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> goes to auction!&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auction_property</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;auction_started&quot;</span>

        <span class="k">if</span> <span class="n">decision</span> <span class="o">==</span> <span class="s2">&quot;buy&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buy_property</span><span class="p">(</span><span class="n">player</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> bought </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;purchase_completed&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Insufficient funds - </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> goes to auction!&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auction_property</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;auction_started&quot;</span>
        <span class="k">elif</span> <span class="n">decision</span> <span class="o">==</span> <span class="s2">&quot;auction&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> declined to buy </span><span class="si">{</span><span class="n">property_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auction_property</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;auction_started&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Invalid decision. Must be &#39;buy&#39; or &#39;auction&#39;&quot;</span></div>


<div class="viewcode-block" id="GameLogic.handle_birthday_collection">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_birthday_collection">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_birthday_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">birthday_player</span><span class="p">):</span>
        <span class="n">total_collected</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🎂 </span><span class="si">{</span><span class="n">birthday_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;s Birthday! Each player must pay £10&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">birthday_player</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> needs to pay £10&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">10</span>
                <span class="n">total_collected</span> <span class="o">+=</span> <span class="mi">10</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £10&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">needed_amount</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> needs to raise £</span><span class="si">{</span><span class="n">needed_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_ai_bankruptcy_prevention</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">needed_amount</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">10</span>
                        <span class="n">total_collected</span> <span class="o">+=</span> <span class="mi">10</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> raised funds and paid £10&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> cannot pay and goes bankrupt&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handle_bankruptcy</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">total_collected</span> <span class="o">+=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
                        <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">birthday_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">total_collected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">birthday_player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> collected £</span><span class="si">{</span><span class="n">total_collected</span><span class="si">}</span><span class="s2"> in total!&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">birthday_player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span></div>


<div class="viewcode-block" id="GameLogic.handle_payment_to_bank">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_payment_to_bank">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_payment_to_bank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">to_free_parking</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> needs to pay £</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">:</span>
            <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span>
            <span class="k">if</span> <span class="n">to_free_parking</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="n">amount</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">amount</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> paid £</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">needed_amount</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">-</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> needs to raise £</span><span class="si">{</span><span class="n">needed_amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_ai_bankruptcy_prevention</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">needed_amount</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">:</span>
                    <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span>
                    <span class="k">if</span> <span class="n">to_free_parking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="n">amount</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">amount</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> raised funds and paid £</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> cannot pay and goes bankrupt&quot;</span><span class="p">)</span>
                <span class="n">remaining_money</span> <span class="o">=</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_bankruptcy</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">remaining_money</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">to_free_parking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span> <span class="o">+=</span> <span class="n">remaining_money</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span> <span class="o">+=</span> <span class="n">remaining_money</span>

            <span class="k">return</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span></div>


<div class="viewcode-block" id="GameLogic.handle_repair_assessment">
<a class="viewcode-back" href="../../modules/game_logic.html#src.Game_Logic.GameLogic.handle_repair_assessment">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_repair_assessment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">house_cost</span><span class="p">,</span> <span class="n">hotel_cost</span><span class="p">):</span>

        <span class="n">repair_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_repair_cost</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">house_cost</span><span class="p">,</span> <span class="n">hotel_cost</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">repair_cost</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is assessed £</span><span class="si">{</span><span class="n">repair_cost</span><span class="si">}</span><span class="s2"> for repairs (£</span><span class="si">{</span><span class="n">house_cost</span><span class="si">}</span><span class="s2">/house, £</span><span class="si">{</span><span class="n">hotel_cost</span><span class="si">}</span><span class="s2">/hotel)&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_payment_to_bank</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">repair_cost</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> has no houses or hotels - no repair costs&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">player</span><span class="p">[</span><span class="s2">&quot;money&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bank_money</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_parking_fund</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Software Engineering Project Group 5 Eric Shi, Stuart Baker, Lin Moe Hein, Duncan Law, Owen Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>